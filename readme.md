# AttachmentSet - ç±»å‹å®‰å…¨çš„åŠ¨æ€é™„ä»¶å®¹å™¨

## ç‰¹æ€§æ¦‚è¿°

### æ ¸å¿ƒåŠŸèƒ½
- âœ… **åŠ¨æ€ç±»å‹å­˜å‚¨**ï¼šæ”¯æŒä»»æ„ç±»å‹çš„`shared_ptr`å®‰å…¨å­˜å‚¨
- âœ… **ç±»å‹å®‰å…¨è®¿é—®**ï¼šç¼–è¯‘æœŸç±»å‹æ£€æŸ¥ + è¿è¡Œæ—¶ç±»å‹éªŒè¯
- âœ… **å¼•ç”¨è®¡æ•°ç»´æŠ¤**ï¼šè‡ªåŠ¨ç®¡ç†`shared_ptr`ç”Ÿå‘½å‘¨æœŸ
- âœ… **è¿­ä»£å™¨æ”¯æŒ**ï¼šSTLé£æ ¼è¿­ä»£å™¨éå†æ‰€æœ‰é™„ä»¶

### å®ç°äº®ç‚¹
- ğŸš€ åŸºäº`std::any`+ç±»å‹æ“¦é™¤å®ç°åŠ¨æ€ç±»å‹
- ğŸ”’ ä½¿ç”¨`std::type_index`ä¿è¯ç±»å‹å®‰å…¨
- ğŸ§© æ¨¡æ¿åŒ–æ¥å£æä¾›ç¼–è¯‘æœŸç±»å‹æ£€æŸ¥

## åŸºæœ¬ç”¨æ³•

```cpp
// å®šä¹‰å®¹å™¨
demo::AttachmentSet attachments;

// å­˜å‚¨é™„ä»¶
attachments.set<MyClass>("obj", std::make_shared<MyClass>());
attachments.set<int>("value", std::make_shared<int>(42));

// è·å–é™„ä»¶
if (auto ptr = attachments.get<MyClass>("obj")) {
    ptr->doSomething();
}

// ç±»å‹æ£€æŸ¥
if (attachments.is<int>("value")) {
    // å®‰å…¨æ“ä½œ...
}

// éå†é™„ä»¶
for (auto it = attachments.begin(); it != attachments.end(); ++it) {
    if (it.is<MyClass>()) {
        auto obj = it.get<MyClass>();
    }
}
```

## è®¾è®¡ä¼˜åŠ¿

1. **ç±»å‹å®‰å…¨**
   - æœç»é”™è¯¯ç±»å‹è½¬æ¢
   - é¿å…`std::bad_any_cast`å¼‚å¸¸

2. **æ€§èƒ½ä¼˜åŒ–**
   - ä½¿ç”¨è¿ç»­å†…å­˜å­˜å‚¨ï¼ˆstd::vectorï¼‰
   - å¿«é€Ÿç±»å‹æ¯”è¾ƒï¼ˆtype_indexå“ˆå¸Œï¼‰

3. **æ‰©å±•æ€§**
   - æ— éœ€é¢„å®šä¹‰æ”¯æŒçš„ç±»å‹
   - å¯åŠ¨æ€æ·»åŠ æ–°ç±»å‹æ”¯æŒ

## é€‚ç”¨åœºæ™¯
- éœ€è¦åŠ¨æ€å…³è”æ•°æ®çš„å¯¹è±¡ç³»ç»Ÿ
- æ’ä»¶æ¶æ„ä¸­çš„æ‰©å±•ç‚¹å®ç°
- è·¨æ¨¡å—é€šä¿¡æ—¶çš„ç±»å‹å®‰å…¨åŒ…è£…